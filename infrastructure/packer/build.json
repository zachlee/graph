{
  "_comment" : "Simple Packer Template using Amazon Linux 2017.03",
  "variables": {
    "aws_access_key": "",
    "aws_secret_key": "",
    "jenkins_build_version": ""
  },
  "builders": [{
    "type": "amazon-ebs",
    "access_key": "{{user `aws_access_key`}}",
    "secret_key": "{{user `aws_secret_key`}}",
    "region": "us-west-2",
    "source_ami": "ami-0bf50cb14f91a96b2",
    "instance_type": "t2.micro",
    "ssh_username": "ec2-user",
    "ami_name": "AMI Running Graph on Docker"
  }],
  "provisioners":[
    {
      "type":"shell",
      "inline":[
        "sleep 30",
        "docker pull 54.184.253.228:5000/graph:{{user `jenkins_build_version`}}",
        "docker run -d -p 7000:7000 54.184.253.228:5000/graph:{{user `jenkins_build_version`}}"
      ]
    }
  ]
}